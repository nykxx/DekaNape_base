# How to Remap

以下の手順に従って自由にキーマップを変更してください。

## Step1

このリポジトリをForkします。

## Step2

config/DekaNape.keymap を編集します。

## Step3

変更をCommitし、Pushします。  
PushするとGithubActionsで自動的にビルドが実行されます。

ビルド結果であるはページ上部の「Actions」から取得することができます。

## Step4

ダウンロードしたFWをDekaNapeに書き込みます。

書き込みは2種類の方法があります。

# How to load FW

## Method1 Press the reset button

DekaNapeのケースを開けた状態でUSB接続し、xiaoのリセットボタンを素早く2回押します。

ケースは4か所の突起ではめ込んであるので、うまく力を入れて破損させないように開封します。  
突起の位置は下記の画像を参照してください。見えている突起は2か所ですが、反対側にも2つあります。

![uppercase](img/uppercase.png)

---
**Caution**

上ケースと下ケースはセンサー、電源スイッチの2つで上ケースと配線がつながっています。

ケース開封時に勢いよく引きはがすと配線を傷める恐れがあるので、開封は慎重に行ってください。

---

うまく行けば書き込み用のドライブが表示されるので、ダウンロードした.uf2ファイルをそのままドラッグアンドドロップします。

FWの転送が完了すると自動的にドライブはアンマウントされます。

その際、エラー表示となることがありますが正常です。（特にLinux,Macの場合は書き込みに失敗しましたなどとメッセージがでますが、問題なく書き込めています。）

## Method2 Enter the bootmode

初期状態のキーマップだと、左上のキーと右下のキーの2つを同時押し(コンボ)→右上のキーを押すとブートモードに入ります。

![combo_to_boot](img/combo_to_boot.png)

画像のコンボでbootレイヤーに入ります。コンボを押したままさらに右上のキーも押すとブートモードに入ります。

上記の説明ではわかりづらいので、キーマップファイルを参照し、コンボ位置と&bootloaderの位置を確認してください。

USB接続状態で上記コマンドを実行することでブートモードに入り書き込み用ドライブが表示されるので、そこにFWをドラッグアンドドロップすれば書き込みできます。

注意点などは上記と同じです。

## Mouse Keys

キーマップの設定でマウスキーを設定する際は以下の公式ページを参照してください。

https://zmk.dev/docs/keymaps/behaviors/mouse-emulation


ざっくりMB1～MB5を設定できると思っておけばOKです。

|キー設定 |  意味合い         |
|--------|------------------|
|MB1     |左クリック           |
|MB2     |右クリック           |
|MB3     |中クリック           |
|MB4     |多くの場合、戻るボタン|
|MB5     |多くの場合、進むボタン|

もちろんマウスキー以外の通常キーも設定できます。

comboやその他behavior等も適宜追加してもらえます。


Keymap Editorには対応していますのでそちらを利用するのもいいと思います。

https://nickcoutsos.github.io/keymap-editor/


初期キーマップでは設定していませんが、マウスジェスチャー用モジュールも組み込んで用意はしています。

詳細は以下リポジトリを参照してください。

https://github.com/kot149/zmk-mouse-gesture

